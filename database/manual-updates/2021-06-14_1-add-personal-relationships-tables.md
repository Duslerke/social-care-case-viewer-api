# Add personal relationships tables

## The problem we're trying to solve

We need to add three new tables to store personal relationships.

## Justification for doing a manual update

We don't have database migrations set up for the API.

## The plan

1. Run SQL statements to create the tables in Staging
2. Run SQL statements to create the tables in Production

## Link to Jira ticket

https://hackney.atlassian.net/browse/SCT-409

## SQL statement(s)

```sql
CREATE TABLE IF NOT EXISTS dbo.sccv_personal_relationship_type (
    id bigint GENERATED BY DEFAULT AS IDENTITY NOT NULL CONSTRAINT xpk_personal_relationship_type PRIMARY KEY,
    description varchar(300),
    inverse_type_id bigint
);

CREATE TABLE IF NOT EXISTS dbo.sccv_personal_relationship (
    id bigint GENERATED BY DEFAULT AS IDENTITY NOT NULL CONSTRAINT xpk_personal_relationship PRIMARY KEY,
    fk_person_id bigint,
    fk_other_person_id bigint,
    fk_personal_relationship_type_id bigint,
    sccv_created_at timestamp,
    sccv_created_by varchar(300),
    sccv_last_modified_at timestamp,
    sccv_last_modified_by varchar(300),
    CONSTRAINT fk_personal_relationship_type
        FOREIGN KEY(fk_personal_relationship_type_id)
        REFERENCES dbo.sccv_personal_relationship_type(id),
    CONSTRAINT fk_person
        FOREIGN KEY(fk_person_id)
        REFERENCES dbo.dm_persons(person_id),
    CONSTRAINT fk_other_person
        FOREIGN KEY(fk_other_person_id)
        REFERENCES dbo.dm_persons(person_id)
);

CREATE TABLE IF NOT EXISTS dbo.sccv_personal_relationship_detail (
    id bigint GENERATED BY DEFAULT AS IDENTITY NOT NULL CONSTRAINT xpk_personal_relationship_detail PRIMARY KEY,
    fk_personal_relationship_id bigint,
    details varchar(1000),
    sccv_created_at timestamp,
    sccv_created_by varchar(300),
    sccv_last_modified_at timestamp,
    sccv_last_modified_by varchar(300),
    CONSTRAINT fk_personal_relationship
        FOREIGN KEY(fk_personal_relationship_id)
        REFERENCES dbo.sccv_personal_relationship(id)
        ON DELETE CASCADE
);
```

## Useful resources

N/A
